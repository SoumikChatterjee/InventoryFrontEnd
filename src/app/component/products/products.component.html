<div class="top-row">
    <h2 *ngIf="products.length>0">Product List</h2>
    <a class="btn btn-primary" routerLink="/add-product" *ngIf="au.user.role==='Admin'||au.user.role==='Manager'">Add Product</a>
</div>
<h2 *ngIf="products.length===0">Sorry no products to display</h2>
<div class="custom-container">

    <!-- Lazy loading cards -->
    <div class="card" aria-hidden="true" id="ld" *ngIf="loading">
        <img src="..." class="card-img-top" alt="">
        <div class="card-body">
            <h5 class="card-title placeholder-glow">
                <span class="placeholder col-6"></span>
            </h5>
            <p class="card-text placeholder-glow">
                <span class="placeholder col-7"></span>
                <span class="placeholder col-4"></span>
                <span class="placeholder col-4"></span>
                <span class="placeholder col-6"></span>
                <span class="placeholder col-8"></span>
            </p>
            <a class="btn btn-primary disabled placeholder col-6" aria-disabled="true"></a>
        </div>
    </div>
    <div class="card" aria-hidden="true" id="ld" *ngIf="loading">
        <img src="..." class="card-img-top" alt="">
        <div class="card-body">
            <h5 class="card-title placeholder-glow">
                <span class="placeholder col-6"></span>
            </h5>
            <p class="card-text placeholder-glow">
                <span class="placeholder col-7"></span>
                <span class="placeholder col-4"></span>
                <span class="placeholder col-4"></span>
                <span class="placeholder col-6"></span>
                <span class="placeholder col-8"></span>
            </p>
            <a class="btn btn-primary disabled placeholder col-6" aria-disabled="true"></a>
        </div>
    </div>
    <div class="card" aria-hidden="true" id="ld" *ngIf="loading">
        <img src="" class="card-img-top" alt="">
        <div class="card-body">
            <h5 class="card-title placeholder-glow">
                <span class="placeholder col-6"></span>
            </h5>
            <p class="card-text placeholder-glow">
                <span class="placeholder col-7"></span>
                <span class="placeholder col-4"></span>
                <span class="placeholder col-4"></span>
                <span class="placeholder col-6"></span>
                <span class="placeholder col-8"></span>
            </p>
            <a class="btn btn-primary disabled placeholder col-6" aria-disabled="true"></a>
        </div>
    </div>

    <!-- Actual Cards after rendering -->

    <div *ngFor="let p of filteredProducts" class="container-custom">



        <div [ngClass]="{'card': true}" style="width: 18rem;" >
            <div class="img-holder">
                <img [src]="p.images[0]" class="card-img-top" alt="...">
            </div>
            <div class="price-hover">
                â‚¹ {{p.price}}
            </div>
            <div class="card-body">
                <div [ngClass]="{'lowstockalert':true,'card-low-quantity': p.quantity < 10}" >
                    LOW STOCK <i class="fa-solid fa-triangle-exclamation"></i></div>
                <span class="card-title">{{p.name}}</span>


                <p class="card-text">{{p.description | slice:0:25}}...</p>
                <div class="buttons">
                    <a class="btn btn-primary" id="add" *ngIf="au.user.role==='Admin'||au.user.role==='Manager'" (click)="order(p.id)" (keydown)="handleButtonClick($event)" tabindex="0">Restock</a>
                    <a class="btn" (click)="deleteOrder(p.id)" id="add" *ngIf="au.user.role==='User'" (keydown)="handleButtonClick($event)" tabindex="0"><i class="fa-solid fa-minus"></i></a>
                    <a class="btn" (click)="order(p.id)" id="add" *ngIf="au.user.role==='User'" (keydown)="handleButtonClick($event)" tabindex="0"><i class="fa-solid fa-plus"></i></a>
                    <a class="btn" id="view" *ngIf="au.user.role==='Admin'||au.user.role==='User'||au.user.role==='Admin'||au.user.role==='Manager'" routerLink="/product-details/{{p.id}}" (keydown)="handleButtonClick($event)" tabindex="0"><i class="fa-solid fa-eye"></i></a>
                    <a class="btn" id="view" *ngIf="au.user.role==='Admin'||au.user.role==='Manager'" routerLink="/edit-product/{{p.id}}" (keydown)="handleButtonClick($event)" tabindex="0"><i class="fa-regular fa-pen-to-square"></i></a>
                    <a class="btn" id="view" *ngIf="au.user.role==='Admin'" (click)="deleteProduct(p.id)" (keydown)="handleButtonClick($event)" tabindex="0"><i class="fa-solid fa-trash"></i></a>
                  </div>
            </div>
        </div>
    </div>
</div>